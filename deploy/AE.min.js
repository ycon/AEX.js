/*

 Released under the MIT license
 Author: Yannick Connan
 Version: 0.1.1 - Build: 18027 (2012/04/28 07:55 PM)
*/
(function(T){var q={VERSION:"0.1.1"};(function(a){function b(a,b,c,d,f){this._listener=b;this._isOnce=c;this.context=d;this._signal=a;this._priority=f||0}function c(a,b){if("function"!==typeof a)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));}var d={VERSION:"0.7.1"};b.prototype={active:!0,params:null,execute:function(a){var b;this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,a),this._isOnce&&this.detach());
return b},detach:function(){return this.isBound()?this._signal.remove(this._listener):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};d.Signal=function(){this._bindings=[];this._prevParams=null};
d.Signal.prototype={memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,c,d,i){var f=this._indexOfListener(a);if(-1!==f){if(a=this._bindings[f],a.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(!c?"":"Once")+"() the same listener without removing the relationship first.");}else a=new b(this,a,c,d,i),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&
a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a){for(var b=this._bindings.length;b--;)if(this._bindings[b]._listener===a)return b;return-1},has:function(a){return-1!==this._indexOfListener(a)},add:function(a,b,d){c(a,"add");return this._registerListener(a,!1,b,d)},addOnce:function(a,b,d){c(a,"addOnce");return this._registerListener(a,!0,b,d)},remove:function(a){c(a,"remove");var b=this._indexOfListener(a);-1!==b&&(this._bindings[b]._destroy(),
this._bindings.splice(b,1));return a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b=Array.prototype.slice.call(arguments),c=this._bindings.length,d;if(this.memorize)this._prevParams=b;if(c){d=this._bindings.slice();this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&!1!==d[c].execute(b))}}},
forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};"function"===typeof define&&define.amd?define("signals",[],d):"undefined"!==typeof module&&module.exports?module.exports=d:a.signals=d})(this);var M=this.signals;if(!Function.prototype.bind)Function.prototype.bind=function(a){var b=this;if("function"!==typeof b)throw new TypeError("Function.prototype.bind called on incompatible "+
b);var c=slice.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var e=new e,g=b.apply(e,c.concat(slice.call(arguments)));return Object(g)===g?g:e}return b.apply(a,c.concat(slice.call(arguments)))};return d};if(!Array.isArray)Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){var b,c;"a"!="a"[0]&&"string"==typeof o&&o&&(b=this.split(""));b=Object(this);c=
b.length>>>0;if(!c)return-1;var d=0;1<arguments.length&&(d=toInteger(arguments[1]));for(d=0<=d?d:Math.max(0,c+d);d<c;d++)if(d in b&&b[d]===a)return d;return-1};var D=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},P=function(a){for(var b=[a],c=0,d=G.length,a=D(a);c<d;c+=1)b.push(G[c]+a);return b},G="Webkit Moz O ms Khtml".split(" "),l={TRANSFORM:"Transform",TRANSFORM_STYLE:"transformStyle",PERSPECTIVE:"perspective",ORIGIN:"perspectiveOrigin",getLocalBound:function(a){for(var b=0,c=0,d=0,
e=0,a=a.childNodes,g=a.length,h=0,i=Math.min,f=Math.max,k=1,j,m,K,l;h<g;h+=1)if(j=a[0],1===j.nodeType&&j.childNodes.length){k=parseFloat(j.style.zoom)||1;j=j.childNodes;K=j.length;for(l=0;l<K;l+=1)m=j[l],b=i(m.offsetLeft*k,b),d=i(m.offsetTop*k,d),c=f((m.offsetWidth+m.offsetLeft)*k,c),e=f((m.offsetHeight+m.offsetTop)*k,e)}else b=i(j.offsetLeft,b),d=i(j.offsetTop,d),c=f(j.offsetWidth+j.offsetLeft,c),e=f(j.offsetHeight+j.offsetTop,e);return{x:b,y:d,width:c-b,height:e-d}}};l.haveTransform=function(){var a=
document.createElement("div"),b=P(this.TRANSFORM),c=0,d=b.length;if(a)for(;c<d;c+=1)if(c&&void 0!==a.style[b[c]])return this.TRANSFORM=G[c-1]+D(this.TRANSFORM),!0;return!1}.call(l);l.have3DTransform=function(){var a=document.createElement("div"),b=P(this.PERSPECTIVE),c=0,d=b.length;if(a)for(;c<d;c+=1)if(c&&void 0!==a.style[b[c]])return a=G[c-1],this.PERSPECTIVE=a+D(this.PERSPECTIVE),this.ORIGIN=a+D(this.ORIGIN),this.TRANSFORM_STYLE=a+D(this.TRANSFORM_STYLE),!0;return!1}.call(l);l.haveIEFilter=function(){var a=
document.createElement("div");return a&&void 0!==a.style.filter?(a.style.width=a.style.height="100px",a.style.filter="progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand')",void 0!==a.onfilterchange):!1}.call(l);q.Browser=l;var H=function(a,b,c,d){var e=0.5*(b-a),a=0.5*(a+b),b=d.clone();sum=0.3478548451*b.multiplyScalar(2*(a+-0.8611363116*e)).add(c).lengthSq();sum+=0.3478548451*b.copy(d).multiplyScalar(2*(a+0.8611363116*e)).add(c).lengthSq();sum+=0.6521451549*b.copy(d).multiplyScalar(2*
(a+-0.3399810436*e)).add(c).lengthSq();return sum+=0.6521451549*b.copy(d).multiplyScalar(2*(a+0.3399810436*e)).add(c).lengthSq()},Q=function(a,b,c,d,e,g){var h=a.clone(),i=d.clone();if(c.equals(d))return e.curveTo(h.lerp(b,0.89),d),e;if(b.equals(a))return e.curveTo(i.lerp(c,0.89),d),e;h.lerp(b,1.5);i.lerp(c,1.5);g||(g=(Math.max(Math.max(h.max(),i.max()),Math.max(a.max(),d.max()))-Math.min(Math.min(h.min(),i.min()),Math.min(a.min(),d.min())))/350);var f=Math.sqrt(10.3923048/h.distance(i)*g);if(1<f)e.curveTo(h.lerp(i,
0.5),d);else{var a=a.clone(),k=a.clone().lerp(b,f),j=c.clone().lerp(d,f),m=b.clone().lerp(c,f),K=k.clone().lerp(m,f),b=m.lerp(j,f),l=K.clone().lerp(b,f),h=a.clone().lerp(k,1.5);i.copy(l).lerp(K,1.5);e.curveTo(h.lerp(i,0.5),l.clone());0.5>f&&(f=1-f/(1-f),b=b.clone(),c=j.clone(),a.copy(l),k.copy(a).lerp(b,f),j.copy(c).lerp(d,f),m.copy(b).lerp(c,f),K.copy(k).lerp(m,f),b=m.lerp(j,f),l.copy(K).lerp(b,f),Q(a,k,K.clone(),l.clone(),e,g));h=l.clone().lerp(b,1.5);i=d.clone().lerp(j,1.5);e.curveTo(h.lerp(i,
0.5),d.clone())}return e},R=function(a){if(!(a instanceof this.type_))throw"not the right type";},t=function(a){this.items_=[];this.type_=Object;if(a&&a.prototype instanceof this.type_)this.type_=a;this.on={add:new M.Signal,remove:new M.Signal,swap:new M.Signal}};t.prototype={constructor:t,items_:null,type_:null,index:function(a){return this.items_.indexOf(a)},have:function(a){return-1!==this.index(a)},get:function(a){return this.items_[a]},getLength:function(){return this.items_.length},add:function(a){R.call(this,
a);if(this.have(a))throw"item already present";this.items_.push(a);this.on.add.dispatch(a,this.length-1,this)},insert:function(a,b){R.call(this,a);var c=this.items_;if(this.have(a))throw"item already present";b<c.length?c.splice(b,0,a):c.push(a);c=Math.max(b,this.length-1);this.on.add.dispatch(a,c,this)},remove:function(a){var b=this.items_,c=b.indexOf(a);if(-1!==c)b.splice(c,1),this.on.remove.dispatch(a,c,this);else throw"item not present";},swap:function(a,b){var c=this.items_,d=c.indexOf(a),e=
c.indexOf(b);if(-1!==d&&-1!==e)c[d]=b,c[e]=a,this.on.swap.dispatch(d,e,this);else throw"one of the items not present";},each:function(a){for(var b=this.items_,c=b.length,d=0;d<c;d++)a(b[d])}};q.Stack=t;var U={ease:function(a,b,c,d,e,g){b=b||0;d=d||0;a=this.solveCurveX(a||0,c||0,e||0,g);c=3*b;b=3*(d-b)-c;return(((1-c-b)*a+b)*a+c)*a},solveCurveX:function(a,b,c,d){var e=this.fabs,g=3*a,a=3*(b-a)-g,b=1-g-a,h=2*a,i=3*b,f,k,j,m;d||(d=1.0E-4);f=c;m=0;a:for(;8>m;m++){k=((b*f+a)*f+g)*f-c;if(e(k)<d)return f;
j=(i*f+h)*f+g;if(1.0E-6>e(j))break a;f-=k/j}h=0;i=1;f=c;if(f<h)return h;if(f>i)return i;for(m=0;h<i&&10>m;){k=((b*f+a)*f+g)*f;if(e(k-c)<d)break;c>k?h=f:i=f;f=0.5*(i-h)+h;m++}return f},fabs:function(a){return 0<=a?a:0-a}},n=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};n.isVector=function(a){return a&&"number"===typeof a.x&&"number"===typeof a.y};n.prototype={constructor:n,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=
a;return this},setZ:function(a){this.z=a;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z||0;return this},clone:function(){return new n(this.x,this.y,this.z)},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},
divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},
cross:function(a){var b=this.x,c=this.y,d=this.z;this.x=c*a.z-d*a.y;this.y=d*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},distance:function(a){return Math.sqrt(this.distanceSq(a))},distanceSq:function(a){return this.clone().sub(a).lengthSq()},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},isZero:function(){return 1.0E-4>this.lengthSq()},max:function(){return Math.max(this.x,Math.max(this.y,this.z))},min:function(){return Math.min(this.x,Math.min(this.y,this.z))},setFromQuaternion:function(a){this.x=
Math.atan2(2*(a.x*a.w-a.y*a.z),a.w*a.w-a.x*a.x-a.y*a.y+a.z*a.z);this.y=Math.asin(2*(a.x*a.z+a.y*a.w));this.z=Math.atan2(2*(a.z*a.w-a.x*a.y),a.w*a.w+a.x*a.x-a.y*a.y-a.z*a.z)}};q.Vector=n;var p=function(){arguments.length&&this.injectArray(arguments)};p.tMat_=new p;p.tVec1_=new n;p.tVec2_=new n;p.tVec3_=new n;p.prototype={constructor:p,m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,set:function(a,b,c,d,e,g,h,i,f,k,j,m,l,n,p,q){this.m11=a;this.m12=b;this.m13=
c;this.m14=d;this.m21=e;this.m22=g;this.m23=h;this.m24=i;this.m31=f;this.m32=k;this.m33=j;this.m34=m;this.m41=l;this.m42=n;this.m43=p;this.m44=q;return this},injectArray:function(a){return this.set.apply(this,a)},injectMatrix:function(a){this.m11=a.m11;this.m12=a.m12;this.m13=a.m13;this.m14=a.m14;this.m21=a.m21;this.m22=a.m22;this.m23=a.m23;this.m24=a.m24;this.m31=a.m31;this.m32=a.m32;this.m33=a.m33;this.m34=a.m34;this.m41=a.m41;this.m42=a.m42;this.m43=a.m43;this.m44=a.m44;return this},identity:function(){this.set(1,
0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},translation:function(a,b,c){this.set(1,0,0,0,0,1,0,0,0,0,1,0,a||0,b||0,c||0,1);return this},translate:function(a,b,c){this.m41+=a||0;this.m42+=b||0;this.m43+=c||0;return this},scaling:function(a,b,c){this.set(a||0,0,0,0,0,b||0,0,0,0,0,c||0,0,0,0,0,1);return this},scale:function(a,b,c){a=a||1.0E-6;b=b||1.0E-6;c=c||1.0E-6;if(1!==a||1!==b||1!==c)this.m11*=a,this.m21*=a,this.m31*=a,this.m41*=a,this.m12*=b,this.m22*=b,this.m32*=b,this.m42*=b,this.m13*=c,this.m23*=
c,this.m33*=c,this.m43*=c;return this},rotation:function(a,b,c){this.identity();var d=Math.PI/180,a=(a||0)*d,b=(b||0)*d,c=(-c||0)*d,e=Math.cos,g=Math.sin,d=e(a),a=g(a),h=e(b),b=g(b),e=e(c),c=g(c),g=d*e,i=d*c,f=a*e,k=a*c;this.m11=h*e;this.m12=f*b-i;this.m13=g*b+k;this.m21=h*c;this.m22=k*b+g;this.m23=i*b-f;this.m31=-b;this.m32=a*h;this.m33=d*h;this.m41=this.m42=this.m43=0;return this},rotate:function(a,b,c){if(!this.temp_)this.temp_=new p;return a||b||c?this.multiply(this.temp_.rotation(a,b,c)):this},
quaternionRotation:function(a,b,c,d){var e=d*d,g=a*a,h=b*b,i=c*c,f=1/(g+h+i+e);this.m11=(g-h-i+e)*f;this.m22=(-g+h-i+e)*f;this.m33=(-g-h+i+e)*f;e=a*b;g=c*d;this.m21=2*(e+g)*f;this.m12=2*(e-g)*f;e=a*c;g=b*d;this.m31=2*(e-g)*f;this.m13=2*(e+g)*f;e=b*c;g=a*d;this.m32=2*(e+g)*f;this.m23=2*(e-g)*f;return this},quaternionRotate:function(a,b,c,d){if(!this.temp_)this.temp_=new p;return this.multiply(this.temp_.quaternionRotation(a,b,c,!d&&0!==d?1:d))},lookingAt:function(a,b,c){var d=p.tVec1_.set(0,1,0),e=
p.tVec2_,a=p.tVec3_.set(-a,-b,c).normalize();d.cross(a);e.copy(a).cross(d);d.normalize();e.normalize();this.set(d.x,d.y,d.z,0,e.x,e.y,e.z,0,a.x,a.y,a.z,0,0,0,0,1);return this},lookAt:function(a,b,c){if(!this.temp_)this.temp_=new p;return a||b?this.multiply(this.temp_.lookingAt(a,b,c)):this},determinant:function(){return-this.m13*this.m22*this.m31+this.m12*this.m23*this.m31+this.m13*this.m21*this.m32-this.m11*this.m23*this.m32-this.m12*this.m21*this.m33+this.m11*this.m22*this.m33},invert:function(){var a=
this.m11,b=this.m12,c=this.m13,d=this.m21,e=this.m22,g=this.m23,h=this.m31,i=this.m32,f=this.m33,k=this.m41,j=this.m42,m=this.m43,l=1/this.determinant();this.m11=(-g*i+e*f)*l;this.m12=(c*i-b*f)*l;this.m13=(-c*e+b*g)*l;this.m14=0;this.m21=(g*h-d*f)*l;this.m22=(-c*h+a*f)*l;this.m23=(c*d-a*g)*l;this.m24=0;this.m31=(-e*h+d*i)*l;this.m32=(b*h-a*i)*l;this.m33=(-b*d+a*e)*l;this.m34=0;this.m41=(g*i*k-e*f*k-g*h*j+d*f*j+e*h*m-d*i*m)*l;this.m42=(b*f*k-c*i*k+c*h*j-a*f*j-b*h*m+a*i*m)*l;this.m43=(c*e*k-b*g*k-c*
d*j+a*g*j+b*d*m-a*e*m)*l;this.m44=1;return this},createInvert:function(){return this.clone().invert()},clone:function(){return(new p).set(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.m41,this.m42,this.m43,this.m44)},join:function(a,b){var c=a.m11,d=a.m12,e=a.m13,g=a.m14,h=a.m21,i=a.m22,f=a.m23,k=a.m24,j=a.m31,l=a.m32,n=a.m33,p=a.m34,q=a.m41,r=a.m42,s=a.m43,t=a.m44,u=b.m11,v=b.m12,w=b.m13,x=b.m14,y=b.m21,z=b.m22,A=b.m23,B=b.m24,C=
b.m31,D=b.m32,E=b.m33,F=b.m34,G=b.m41,H=b.m42,I=b.m43,J=b.m44;this.m11=c*u+d*y+e*C+g*G;this.m12=c*v+d*z+e*D+g*H;this.m13=c*w+d*A+e*E+g*I;this.m14=c*x+d*B+e*F+g*J;this.m21=h*u+i*y+f*C+k*G;this.m22=h*v+i*z+f*D+k*H;this.m23=h*w+i*A+f*E+k*I;this.m24=h*x+i*B+f*F+k*J;this.m31=j*u+l*y+n*C+p*G;this.m32=j*v+l*z+n*D+p*H;this.m33=j*w+l*A+n*E+p*I;this.m34=j*x+l*B+n*F+p*J;this.m41=q*u+r*y+s*C+t*G;this.m42=q*v+r*z+s*D+t*H;this.m43=q*w+r*A+s*E+t*I;this.m44=q*x+r*B+s*F+t*J;return this},multiply:function(a){return this.join(this,
a)},preMultiply:function(a){return this.join(a,this)},multiplyVector:function(a){var b=a.x;vy=a.y;vz=a.z;a.x=this.m11*b+this.m21*vy+this.m31*vz+this.m41;a.y=this.m12*b+this.m22*vy+this.m32*vz+this.m42;a.z=this.m13*b+this.m23*vy+this.m33*vz+this.m43;return a},toCSS:function(){return"matrix3d("+this.m11.toFixed(4)+","+this.m12.toFixed(4)+","+this.m13.toFixed(4)+","+this.m14.toFixed(4)+","+this.m21.toFixed(4)+","+this.m22.toFixed(4)+","+this.m23.toFixed(4)+","+this.m24.toFixed(4)+","+this.m31.toFixed(4)+
","+this.m32.toFixed(4)+","+this.m33.toFixed(4)+","+this.m34.toFixed(4)+","+this.m41.toFixed(4)+","+this.m42.toFixed(4)+","+this.m43.toFixed(4)+","+this.m44.toFixed(4)+")"},toArray:function(){return[this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.m41,this.m42,this.m43,this.m44]}};q.Matrix=p;var v=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=d||1};v.isQuaternion=function(a){return a&&"number"===typeof a.x&&"number"===
typeof a.y&&"number"===typeof a.w};v.prototype={constructor:v,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c||0;this.w=!d&&0!==d?1:d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z||0;this.w=a.w||1;return this},clone:function(){return new v(this.x,this.y,this.z,this.w)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},multiply:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;this.w=e*a.w-b*a.x-c*a.y-d*a.z;this.x=e*a.x+b*a.w+c*a.z-d*a.y;this.y=e*
a.y+c*a.w+d*a.x-b*a.z;this.z=e*a.z+d*a.w+b*a.y-c*a.x;return this},setFromEuler:function(a){var b=Math.sin,c=Math.cos,d=Math.PI/360,e=a.x*d,g=a.y*d,h=a.z*d,a=c(g),g=b(g),d=c(-h),h=b(-h),c=c(e),b=b(e);if(!this.temp_)this.temp_=new v;this.set(0,0,h,d).multiply(this.temp_.set(0,g,0,a)).multiply(this.temp_.set(b,0,0,c));return this},divideScalar:function(a){a?(this.x/=a,this.y/=a,this.z/=a,this.w/=a):this.w=this.z=this.y=this.x=0;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*
this.z+this.w*this.w},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},lerp:function(a,b){var c=this.x,d=this.y,e=this.z,g=this.w,h=g*a.w+c*a.x+d*a.y+e*a.z,i,f;0>h?(this.set(-a.x,-a.y,-a.z,-a.w),h=-h):this.copy(a);i=Math.acos(h);f=Math.sqrt(1-h*h);if(0.0010>Math.abs(f))return this.set(0.5*(c+a.x),0.5*(d+a.y),0.5*(e+a.z),0.5*(g+a.w)),this;h=Math.sin((1-b)*i)/f;i=Math.sin(b*i)/f;this.set(c*h+this.x*i,d*h+this.y*i,e*h+this.z*i,g*h+this.w*
i);return this},toJSON:function(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};q.Quaternion=v;var I=function(a,b){this.start=a;this.end=b;this.update=!0};I.prototype={constructor:I,length:function(){if(this.update)this.length_=this.start.distance(this.end),this.update=!1;return this.length_},getVect:function(a,b){return(b?b.copy(this.start):this.start.clone()).lerp(this.end,a)}};q.Line=I;var J=function(a,b,c){this.start=a;this.anchor=b;this.end=c;this.temp_=this.start.clone();this.update=!0};J.prototype=
{constructor:J,length:function(){if(this.update){this.update=!1;var a=this.anchor.clone().sub(this.start).multiplyScalar(2),b=this.start.clone().sub(this.anchor.clone().multiplyScalar(2)).add(this.end),c=Math.sqrt,d,e,g;d=c(H(0,0.25,a,b))/5.65685425;e=c(H(0.25,0.5,a,b))/5.65685425;g=c(H(0.5,0.75,a,b))/5.65685425;a=d+e+g+c(H(0.75,1,a,b))/5.65685425;g=(d+e+g)/a;e=(d+e)/a;d/=a;this.length_=a;this.inverse_=[d,e,g,0.5+(1-d/(e-d))/4,0.5-(1-(1-g)/(g-e))/5]}return this.length_},getVect:function(a,b){this.length();
var c,d=this.inverse_,e=d[0],g=d[1],h=d[2];c=d[3];d=d[4];a>=h?(e=(a-h)/(1-h),c=d,g=0.75):a>=g?(e=(a-g)/(h-g),g=0.5,c=d):a>=e?(e=(a-e)/(g-e),g=0.25):(e=a/e,g=0);c=0.25*(2*(1-e)*e*c+e*e)+g;return(b?b.copy(this.start):this.start.clone()).lerp(this.anchor,c).lerp(this.temp_.copy(this.anchor).lerp(this.end,c),c)}};q.QuadCurve=J;var L=function(a){this.start=a||0;this.elements=[];this.update=!0};L.prototype={constructor:L,length:function(){if(this.update){var a=0,b=this.elements.length,c;this.update=!1;
this.lengths_=[a];for(c=0;c<b;c++)a+=this.elements[c].length(),this.lengths_.push(a);this.lastItemPos_=this.lastPos_=0;this.length_=a}return this.length_},getItem:function(a){for(var a=a*this.length(),b=a>=this.lastPos_?1:-1,c=this.elements.length,d,e,g=this.lastItemPos_;g<c;g+=b)if(d=this.lengths_[g],e=this.elements[g],a>=d&&a<d+e.length())return this.lastItemPos_=g,this.lastPos_=d,e},getVect:function(a,b){var c=this.getItem(a),a=a*this.length();return c?c.getVect((a-this.lastPos_)/c.length(),b):
b?b.copy(this.start):this.start.clone()},lineTo:function(a){this.elements.push(new I(this.start,a));this.start=a;this.update=!0},curveTo:function(a,b){this.elements.push(new J(this.start,a,b));this.start=b;this.update=!0},cubicCurveTo:function(a,b,c){this.elements.push(new E(this.start,a,b,c));this.start=c;this.update=!0}};q.Path=L;var E=function(a,b,c,d){this.start=a;this.a1=b;this.a2=c;this.end=d;this.update=!0};E.prototype={constructor:E,length:function(){if(this.update)this.update=!1,this.path=
Q(this.start,this.a1,this.a2,this.end,new L(this.start)),this.length_=this.path.length();return this.length_},getVect:function(a,b){this.length();return this.path.getVect(a,b)}};q.CubicCurve=E;var y=function(a,b,c,d){t.call(this);this.layer=a;this.inPoint=b||0;this.outPoint=c||1/0;this.source=d;this.startTime=0;this.speed=1;this.remap=new x};y.prototype=new t;y.prototype.constructor=y;y.prototype.animate=function(a){var b=this.layer,c=this.items_;if(a>=this.inPoint&&a<=this.outPoint){b.visible=!0;
for(var b=c.length,d=0;d<b;d++)c[d].set(a);this.source&&(this.remap.num()?this.source.animate(this.remap.get(a-this.startTime)):this.source.animate((a-this.startTime)*this.speed))}else b.visible=!1};var A=function(a){t.call(this);this.item=a;this.duration=1;this.frameRate=25;this.clamp=!1};A.prototype=new t;A.prototype.constructor=A;A.prototype.animate=function(a){var b=this.items_,c=b.length,a=a%this.duration;this.clamp&&(a=Math.floor(a*this.frameRate)/this.frameRate);if(a!==this.prevTime_){for(var d=
0;d<c;d++)b[d].animate(a);this.prevTime_=a}};var V=function(a,b,c){this.offset=a;this.position_=0;this.value=b;this.isHold=c;this.outY=this.outX=this.inY=this.inX=0;this.path=this.outTangent=this.inTangent=null;this.update=!1},x=function(a,b){this.target=a;this.property=b;this.keys_=[];this.length_=0};x.prototype={constructor:x,length:function(){var a=this.keys_,b,c,d,e;if(this.update){d=a.length;for(c=e=0;c<d;c++)if(b=a[c],e+=b.offset,b.position_=e,b.update&&b.path&&(b.inTangent||b.outTangent))this.path=
null,b.update=!1;this.length_=e;this.update=!1}return this.length_},num:function(){return this.keys_.length},indexAt:function(a){var b=this.keys_,c=this.prevIndex_||0,d=a>=(this.prevPosition_||0)?1:-1;this.length();this.prevPosition_=a;if(a<=b[0].position_)return this.prevIndex_=0;if(a>=b[b.length-1].position_)return this.prevIndex_=b.length-1;for(;b[c];){if(a>=b[c].position_&&(!b[c+1]||a<b[c+1].position_))return this.prevIndex_=c,this.prevPosition_=a,this.prevIndex_;c+=d}return this.prevIndex_=0},
get:function(a,b){var c=this.indexAt(a),d=this.keys_[c],e;if(0===c&&a<=d.offset||c>=this.num()-1||d.isHold)return d.value;c=this.keys_[c+1];e=(a-d.position_)/c.offset;if(d.outX||d.outY||c.inX||c.inY)e=U.ease(d.outX,d.outY,c.inX,c.inY,e);return this.interpolate(d,c,e,b)},interpolate:function(a,b,c){return a.value+(b.value-a.value)*c},set:function(a){a=this.get(a);this.target[this.property]!==a&&(this.target[this.property]=a)},add:function(a,b,c){b=new V(a,b,c);this.length_+=a;b.position_=this.length_;
this.keys_.push(b);return b}};q.Keys=x;var z=function(a,b){x.call(this,a,b);this.temp_=a[b].clone()};z.prototype=new x;z.prototype.constructor=z;z.prototype.interpolate=function(a,b,c,d){if(a.update)a.path=a.outTangent&&b.inTangent?new E(a.value,a.outTangent.clone().add(a.value),b.inTangent.clone().add(b.value),b.value):null,a.update=!1;return a.path?a.path.getVect(c,d):(d?d.copy(a.value):a.value.clone()).lerp(b.value,c)};z.prototype.set=function(a){var a=this.get(a,this._temp),b=this.target[this.property];
b.equals&&!b.equals(a)&&b.copy(a)};q.SpatialKeys=z;var w=function(){this.is3D=!0;this.parent=null;this.visible=!0;this.name=null;this.type="null";this.matrix_=new p;this.matrix2D_=new p};w.prototype.getMatrix=function(){if(!this.is3D)return this.getMatrix2D();var a=this.matrix_.injectMatrix(this.getLocalMatrix()),b=this.parent;b&&b!==this&&a.multiply(b.getMatrix());return a};w.prototype.getMatrix2D=function(){var a=this.matrix2D_.injectMatrix(this.getLocalMatrix2D()),b=this.parent;b&&a.multiply(b.getMatrix2D());
return a};w.prototype.getLocalMatrix=function(){return new p};w.prototype.getLocalMatrix2D=function(){return new p};var r=function(){w.call(this);this.filters=new t;this.masks=new t;this.collapse=!1;this.position=new n;this.anchor=new n;this.scale=new n(1,1,1);this.rotation=new n;this.orientation=new v;this.opacity=1;this.type="null";this.localMatrix_=new p;this.localMatrix2D_=new p;this.depthPoint_=new n};r.prototype=new w;r.prototype.constructor=r;r.prototype.getLocalMatrix=function(){var a=this.position,
b=this.anchor,c=this.scale,d=this.rotation,e=this.orientation;return this.localMatrix_.translation(-b.x,-b.y,b.z).scale(c.x,c.y,c.z).rotate(d.x,d.y,d.z).quaternionRotate(e.x,e.y,e.z,e.w).translate(a.x,a.y,-a.z)};r.prototype.getLocalMatrix2D=function(){var a=this.position,b=this.anchor,c=this.scale;return this.localMatrix2D_.translation(-b.x,-b.y,0).scale(c.x,c.y,1).rotate(0,0,this.rotation.z).translate(a.x,a.y,0)};r.prototype.getDepthPoint=function(){return this.depthPoint_.set(Math.max(Math.min(this.width||
1024,this.anchor.x),0),Math.max(Math.min(this.height||768,this.anchor.y),0),0)};q.Layer=r;var s=function(){w.call(this);this.position=new n;this.rotation=new n;this.orientation=new v;this.target=new n;this.haveTarget=!0;this.zoom=1333.33;this.center=new n;this.is3D=!0;this.type="camera";this.localMatrix_=new p;this.localMatrix2D_=new p;this.matrixCamera_=new p;this.tempMatrixCamera_=new p};s.prototype=new w;s.prototype.constructor=s;s.prototype.getLocalMatrix=function(){var a=this.rotation,b=this.target,
c=this.position,d=this.orientation,a=this.localMatrix_.rotation(a.x,a.y,a.z);a.m41=a.m42=a.m43=0;a.quaternionRotate(d.x,d.y,d.z,d.w);this.haveTarget&&a.lookAt(b.x-c.x,b.y-c.y,b.z-c.z);a.translate(c.x,c.y,-c.z);return a};s.prototype.getLocalMatrix2D=function(){return this.localMatrix2D_.rotation(0,0,this.rotation.z).translate(this.position.x,this.position.y,0)};s.prototype.getCameraMatrix=function(){var a=this.center;return this.matrixCamera_.translation(a.x,a.y,this.zoom).preMultiply(this.tempMatrixCamera_.identity().injectMatrix(this.getMatrix()).invert())};
s.prototype.align=function(a,b){this.center.x=this.position.x=a;this.center.y=this.position.y=b;this.position.z=-this.zoom};q.Camera=s;var F=function(){r.call(this);this.color="#000000";this.width=640;this.height=360;this.type="solid"};F.prototype=new r;F.prototype.constructor=F;q.Solid=F;var B=function(){r.call(this);var a=new s;a.haveTarget=!1;this.layers=new t(r);this.cameras=new t(s);this.width=640;this.height=360;this.color="#000000";this.type="composition";a.align(this.width/2,this.height/2);
this.defaultCam_=a};B.prototype=new r;B.prototype.constructor=B;B.prototype.getCamera=function(){for(var a=0,b=this.cameras.getLength(),c,a=0;a<b;a+=1)if(c=this.cameras.get(a),c.visible)return c.center.set(this.width/2,this.height/2),c;c=this.defaultCam_;c.align(this.width/2,this.height/2);return c};q.Composition=B;var C=function(){r.call(this);this.text="";this.textPosition=new n;this.height=this.width=150;this.textClass=null;this.fontFamily="Arial";this.textColor="#888888";this.fontSize=18;this.lineHeight=
1.2;this.letterSpacing=0;this.textAlign="left";this.verticalAlign="top";this.collapse=!0;this.type="text"};C.prototype=new r;C.prototype.constructor=C;C.prototype.getDepthPoint=function(){var a=this.textPosition.x,b=this.textPosition.y;"center"===this.textAlign?a+=0.5*this.width:"right"===this.textAlign&&(a+=this.width);"middle"===this.verticalAlign?b+=0.5*this.height:"bottom"===this.verticalAlign&&(b+=this.height);return this.depthPoint_.set(a,b)};q.Text=C;q.AEBuilder={build:function(a){return this.buildItem(a.items[a.root],
a.items)},buildCompItem:function(a,b){var c=new B,d=new A(c),e=a.layers,g={},h={},i="",f,k,j;c.width=a.width;c.height=a.height;c.color=a.color||"#000000";d.duration=a.duration||1;d.frameRate=a.frameRate||25;for(f=0;f<e.length;f++){k=e[f];j=null;switch(k.type){case "Camera":j=this.buildCameraLayer(k);j.layer.center.set(c.width/2,c.height/2);break;case "Text":j=this.buildTextLayer(k);break;default:k.source&&(j=this.buildAVLayer(k,b))}if(j)null!=k.parent&&(g[k.parent]||(g[k.parent]=[]),g[k.parent].push(j.layer)),
h[k.id]=j.layer,d.add(j),j.layer instanceof s?c.cameras.add(j.layer):c.layers.add(j.layer)}for(i in g)if(g.hasOwnProperty(i)&&Array.isArray(g[i])&&h.hasOwnProperty(i))for(f=0;f<g[i].length;f++)g[i][f].parent=h[i];return d},buildSolidItem:function(a){var b=new F,c=new A(b);b.width=a.width;b.height=a.height;b.color=a.color;return c},buildItem:function(a,b){switch(a.type){case "Composition":return this.buildCompItem(a,b);case "Solid":return this.buildSolidItem(a,b);case "Image":return this.buildImageItem(a,
b);case "Video":return this.buildVideoItem(a,b)}},buildImageItem:function(){},buildVideoItem:function(){},buildAVLayer:function(a,b){var c=this.buildItem(b[a.source],b),d=new y(c.item,a.inPoint,a.outPoint);this.setLayerProperties(d,a);d.source=c;d.startTime=a.startTime||0;d.speed=a.speed||1;return d},buildCameraLayer:function(a){var b=new s,c=new y(b,a.inPoint,a.outPoint);b.name=b.name;b.haveTarget="none"!==a.autoOrient||"target"===a.autoOrient;this.setProp(b,"position",c,a.position);this.setProp(b,
"rotation",c,a.rotation);this.setProp(b,"orientation",c,a.orientation);this.setProp(b,"zoom",c,a.zoom);b.haveTarget&&this.setProp(b,"target",c,a.target);return c},buildTextLayer:function(a){var b=new C,c=new y(b,a.inPoint,a.outPoint),d=0,e="text,textPosition,width,height,textClass,fontFamily,textColor,fontSize,lineHeight,letterSpacing,textAlign,verticalAlign".split(","),g=e.length;for(this.setLayerProperties(c,a);d<g;d+=1)this.setProp(b,e[d],c,a[e[d]]);return c},setLayerProperties:function(a,b){var c=
a.layer;c.name=b.name;c.is3D=b.is3D||!1;if(null!=b.collapse)c.collapse=!0===b.collapse;this.setProp(c,"position",a,b.position);this.setProp(c,"anchor",a,b.anchor);this.setProp(c,"scale",a,b.scale);this.setProp(c,"opacity",a,b.opacity);c.is3D?(this.setProp(c,"rotation",a,b.rotation),this.setProp(c,"orientation",a,b.orientation)):this.setProp(c.rotation,"z",a,b.rotation)},setProp:function(a,b,c,d){if(d||0===d){var e,g,h,i,f,k,j,l;g=a[b];if(Array.isArray(d)){g=0;i=(j=d.length&&Array.isArray(d[0])&&n.isVector(d[0][0])||
n.isVector(d[0])||"object"===typeof d[0]&&n.isVector(d[0].v))?new z(a,b):new x(a,b);for(a=0;a<d.length;a++){b=d[a];f="object"===typeof b;h=(k=Array.isArray(b))||!f||b.e&&0===b.e.o;e=k?b[0]:f&&null!=b.v?b.v:b;(l=n.isVector(e))&&(e=void 0!==e.w?new v(e.x,e.y,e.z,e.w):new n(e.x,e.y,e.z));k?g=b[1]:f&&void 0!==b.d&&(g=b.d||0);e=i.add(g,e,h);if(b.e&&Array.isArray(b.e.i))e.inX=b.e.i[0],e.inY=b.e.i[1];if(b.e&&Array.isArray(b.e.o))e.outX=b.e.o[0],e.outY=b.e.o[1];if(j&&b.t){if(Array.isArray(b.t.i))e.inTangent=
new n(b.t.i[0],b.t.i[1],b.t.i[2]);if(Array.isArray(b.t.o))e.outTangent=new n(b.t.o[0],b.t.o[1],b.t.o[2]);e.update=!0}}i&&c.add(i)}else null!=d.x&&null!=d.y?(this.setProp(g,"x",c,d.x),this.setProp(g,"y",c,d.y),null!=d.z&&this.setProp(g,"z",c,d.z),null!=d.w&&this.setProp(g,"w",c,d.w)):a[b]=d}}};var N=function(a){this.element=document.createElement("solid");this.model=a};N.prototype={constructor:N,render:function(){var a=this.element.style,b=this.model;a.width=b.width+"px";a.height=b.height+"px";a.backgroundColor=
b.color}};var O=function(a){this.model=a;this.element=document.createElement("text");this.text=document.createElement("p");this.element.appendChild(this.text);this.offsetY=this.oldY=this.oldX=0;this.oldModel={text:null,textClass:null,fontFamily:null,textColor:null,fontSize:null,lineHeight:null,letterSpacing:null,textAlign:null,verticalAlign:null,width:null,height:null}};O.prototype={constructor:O,checkDifference:function(a,b){var c=!1,d,e,g;for(g in b)b.hasOwnProperty(g)&&(d=a[g],e=b[g],d!==e&&("object"!==
typeof d||null===d)?(c=!0,b[g]=d):null!=d&&d.clone&&d.equals&&!d.equals(e)&&(c=!0,b[g]=d.clone()));return c},render:function(){var a=this.model,b=this.text.style,c=a.fontSize,d=a.height,e=c*a.leading-c,g=0;if(this.checkDifference(this.model,this.oldModel)){e=document.createTextNode(a.text);this.node?this.text.replaceChild(e,this.node):this.text.appendChild(e);this.node=e;b.width=a.width+"px";b.color=a.textColor;b.textAlign=a.textAlign;b.fontFamily=a.fontFamily;b.fontSize=a.fontSize+"px";b.lineHeight=
a.lineHeight+"em";for(e=c*a.lineHeight-c;6>=g&&this.text.offsetHeight-e>=d;)c*=0.92,e=c*a.lineHeight-c,b.fontSize=c+"px",g++;this.offsetY=a.textPosition.y-e/2;c=d-(this.text.offsetHeight-e/2);switch(a.verticalAlign){case "bottom":this.offsetY+=c;break;case "middle":this.offsetY+=c/2}}if(this.oldX!==a.textPosition.x)this.oldX=a.textPosition.x,b.left=this.oldX;if(this.oldY!==this.offsetY)this.oldY=this.offsetY,b.top=this.oldY}};var u=function(a){var b=a.layers.on,c;this.model=a;this.element=document.createElement("composition");
this.collapse=null;this.height=this.width=this.centerY=this.centerX=this.zoom=0;this.layers=[];var d=this;a.layers.each(function(a){if(c=d.generate(a))d.element.firstChild?d.element.insertBefore(c.element,d.element.firstChild):d.element.appendChild(c.element),d.layers.push(c)});b.add.add(this.add,this);b.remove.add(this.remove,this);b.swap.add(this.swap,this);this.matrix_=new p;this.matrix2D_=new p;this.tempMatrix_=new p};u.v1_=new n;u.v2_=new n;u.v3_=new n;u.prototype={constructor:u,add:function(a,
b){var c=this.generate(a),d=thid.element,e;c&&(d.hasChildNodes()||0>b?(e=d.childNodes(),d.insertBefore(c.element,e[e.length-b-1])):d.appendChild(c.element),this.layers.splice(b,0,c))},remove:function(a,b){this.element.removeChild(this.layers[b].element);this.layers.splice(b,1)},swap:function(a,b){var c=this.layers[a];this.layers[a]=this.layers[b];this.layers[b]=c},generate:function(a){var b=document.createElement("layer"),c={model:a,element:b,mask:null,scale:1,opacity:1},d=null;switch(a.type){case "composition":d=
new u(a);break;case "text":d=new O(a);break;case "solid":d=new N(a)}if(d&&d.element)b.appendChild(d.element),c.content=d.element,c.handler=d;if(!l.haveTransform&&l.haveIEFilter)b.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand'); progid:DXImageTransform.Microsoft.Alpha(Opacity=100)";return c},render:function(a,b,c){var d=this.layers,e=this.layers.length,g=this.model,h=this.element.style,a=a?a:g.getCamera(),i=a.getCameraMatrix(),f,k,j;if(this.collapse!==
g.collapse&&(this.collapse=g.collapse,this.setCollapse(),!this.collapse))this.width=this.height=this.zoom=null;if(this.width!==g.width||this.height!==g.height)if(this.width=g.width,this.height=g.height,h.width=this.width.toFixed(4)+"px",h.height=this.height.toFixed(4)+"px",!this.collapse)h.clip="rect(0px, "+this.width+"px, "+this.height+"px, 0px)";if(!this.collapse){if(this.zoom!==a.zoom)this.zoom=a.zoom,l.have3DTransform&&(h[l.PERSPECTIVE]=this.zoom.toString()+"px");if(this.centerX!==a.center.x||
this.centerY!==a.center.y)this.centerX=a.center.x,this.centerY=a.center.y,l.have3DTransform&&(h[l.ORIGIN]=this.centerX.toString()+"px "+this.centerY.toString()+"px")}for(g=0;g<e;g++){f=d[g];if(f.visible!==f.model.visible)f.visible=f.model.visible,h.display=f.visible?"block":"none";if(f.visible&&f.handler&&f.content){k=this.matrix_.injectMatrix(f.model.getMatrix());b&&f.model.is3D?k.multiply(b):c&&!f.model.is3D&&k.multiply(c);if("composition"===f.model.type&&f.model.collapse){if(!f.collapse)f.collapse=
!0,this.cleanTransform(f.element);j=k;f.model.is3D&&(j=this.matrix2D_.injectMatrix(f.model.getMatrix2D()),c&&j.multiply(c));f.handler.render(a,k,j)}else if(f.handler&&f.content){f.model.is3D&&k.multiply(i);if(f.model.collapse){j=k.m21;var m=k.m22,n=k.m23;j=1.2*(f.model.is3D?Math.sqrt(j*j+m*m+n*n)*(this.zoom/(this.zoom-k.m43)):Math.sqrt(j*j+m*m));m=j/f.scale;if(1.3<m||0.77>m)f.scale=0.77<j&&1.1>j?1:j,this.setScale(f.content,j);j=1/f.scale;k.preMultiply(this.tempMatrix_.scaling(j,j,1))}else if(!f.model.collapse&&
f.model.is3D&&1!==f.scale)f.scale=1,this.setScale(f.content,f.scale);f.collapse=f.model.collapse;f.handler.render();this.setMatrix(f.element,k,f.model.is3D?a:null,f.model.getDepthPoint(),f.model.width,f.model.height)}if(f.opacity!==f.model.opacity)f.opacity=f.model.opacity,this.setOpacity(f.element,f.model.opacity);k.identity()}}},setCollapse:function(){var a=this.element.style;this.collapse?(l.have3DTransform&&(a[l.TRANSFORM_STYLE]="",a[l.PERSPECTIVE]="",a[l.PERSPECTIVE_ORIGIN]=""),a.clip="rect(auto ,auto, auto, auto)",
a.overflow=""):(a.overflow="hidden",a[l.TRANSFORM_STYLE]="flat")},setScale:function(a,b){if(l.haveTransform)a.style[l.TRANSFORM]=1!==b?"scale("+b.toFixed(4)+","+b.toFixed(4)+")":"";else if(void 0!==a.style.zoom)a.style.zoom=b},setMatrix:function(a,b,c,d){var e=a.style;if(l.have3DTransform)e[l.TRANSFORM]=b.toCSS();else{var g=b.m11,h=b.m12,i=b.m21,f=b.m22,k=b.m41,j=b.m42;if(c)g=c.center,zoom=c.zoom,j=b.multiplyVector(u.v1_.copy(d)),h=b.multiplyVector(u.v2_.set(d.x+1,d.y,0)),f=b.multiplyVector(u.v3_.set(d.x,
d.y+1,0)),i=zoom/(zoom-j.z),j.x=j.x*i+g.x*(1-i),j.y=j.y*i+g.y*(1-i),i=zoom/(zoom-h.z),h.x=h.x*i+g.x*(1-i),h.y=h.y*i+g.y*(1-i),i=zoom/(zoom-f.z),f.x=f.x*i+g.x*(1-i),f.y=f.y*i+g.y*(1-i),g=h.x-j.x,h=h.y-j.y,i=f.x-j.x,f=f.y-j.y,k=j.x-(d.x*g+d.y*i),j=j.y-(d.x*h+d.y*f);if(l.haveTransform)e[l.TRANSFORM]="matrix("+g.toFixed(4)+","+h.toFixed(4)+","+i.toFixed(4)+","+f.toFixed(4)+","+k.toFixed(4)+","+j.toFixed(4)+")";else{if(l.haveIEFilter&&a.filters.length){d=l.getLocalBound(a);e.width=d.width+"px";e.height=
d.height+"px";if(d.x||d.y){for(var b=a.childNodes,c=b.length,m=0,n;m<c;m+=1)n=b[m],n.style.left=-d.x+"px",n.style.top=-d.y+"px";k+=d.x*g+d.y*i;j+=d.x*h+d.y*f}a=a.filters.item(0);b=Math.min;k+=b(0,b(d.width*g+d.height*i,b(d.width*g,d.height*i)));j+=b(0,b(d.width*h+d.height*f,b(d.width*h,d.height*f)));a.M11=g;a.M12=i;a.M21=h;a.M22=f}e.left=k.toFixed(4)+"px";e.top=j.toFixed(4)+"px"}}},cleanTransform:function(a){a.style[l.TRANSFORM]="";a.style.filter=""},setOpacity:function(a,b){if(void 0!==a.style.opacity)a.style.opacity=
1!==b?b:"";else if(l.haveIEFilter&&2===a.filters.length)a.filters.item(1).Opacity=100*b}};var S=function(a,b){this.scene=new u(a);this.camera=b;this.element=document.createElement("scene");this.element.appendChild(this.scene.element);if(!document.getElementById("AEStyleSheet")){var c=document.createElement("style");c.id="AEStyleSheet";c.type="text/css";c.rel="stylesheet";c.media="screen";c.title="AEStyleSheet";c.styleSheet?(c.styleSheet.cssText="scene * {position:absolute;display:block;top:0px;left:0px;margin:0px;padding:0px;border:0px;word-wrap:break-word;-webkit-font-smoothing:antialiased;transform-origin:0% 0%;-o-transform-origin:0% 0%;-khtml-transform-origin:0% 0%;-moz-transform-origin:0% 0%;-webkit-transform-origin:0% 0%;-ms-transform-origin:0% 0%;}scene layer {-ms-filter: \"progid:DXImageTransform.Microsoft.Matrix(M11='2.0', sizingMethod='auto expand')\"}scene solid {position: absolute}",
console.log(c.styleSheet.cssText)):c.innerHTML="scene * {position:absolute;display:block;top:0px;left:0px;margin:0px;padding:0px;border:0px;word-wrap:break-word;-webkit-font-smoothing:antialiased;transform-origin:0% 0%;-o-transform-origin:0% 0%;-khtml-transform-origin:0% 0%;-moz-transform-origin:0% 0%;-webkit-transform-origin:0% 0%;-ms-transform-origin:0% 0%;}scene layer {-ms-filter: \"progid:DXImageTransform.Microsoft.Matrix(M11='2.0', sizingMethod='auto expand')\"}scene solid {position: absolute}";
document.getElementsByTagName("head")[0].appendChild(c)}if(a.color)this.scene.element.style.backgroundColor=a.color};S.prototype.render=function(){this.scene.render()};q.DomRenderer=S;"function"===typeof define&&define.amd?define("AE",[],q):"undefined"!==typeof module&&module.exports?module.exports=q:T.AE=q})(this);